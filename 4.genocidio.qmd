# El Genocidio

## Víctimas del genocidio

Víctimas del genocidio a partir del 7 de octubre de 2023.

Obtener datos mediante API.

```{r message=FALSE}
# Paquetes
library(httr2)
library(ggplot2)
library(lubridate)
library(dplyr)
library(cowplot)
```

```{r}
# Casualties_daily
# Connect to API and download data
resp <- httr2::request("https://data.techforpalestine.org/api/v2/") |> 
  # Then we location on path
  httr2::req_url_path_append("casualties_daily.json") |> 
  httr2::req_perform()

# transform to df
df <- resp |>
  httr2::resp_body_json(check_type = FALSE, 
                        simplifyVector = TRUE) 

# Preprocesamiento
df <- df |>
  mutate(across(report_date, ~ymd(.x)))
```

Un total de `{r} prettyNum(df$killed_cum[nrow(df)], big.mark = ",", scientific = FALSE)` personas asesinadas en Gaza desde el 7 de octubre de 2023.

```{r}
df |>
  ## HAcer plot
  ggplot(aes(x = report_date,
             y = killed_cum)) +
  geom_col(fill = "#dc0e34") +
  scale_x_date(expand = c(0.1,0.1))+
  scale_y_continuous(expand = c(0,0),
                     labels = scales::comma)+
  labs(x = "Fecha", 
       y = "Personas asesinadas (acumulado)", 
       fill = "Sexo") +
  # Poner tema cowplot
  theme_cowplot()
```

## Víctimas por sexo y edad

```{r}
# Killed in Gaza
# Connect to API and download data
resp <- httr2::request("https://data.techforpalestine.org/api/v2/") |> 
  # Then we location on path
  httr2::req_url_path_append("killed-in-gaza.min.json") |> 
  httr2::req_perform()

# transform to df
df <- resp |>
  httr2::resp_body_json(check_type = FALSE, 
                        simplifyVector = TRUE) 

# Preprocesamiento
df <- df |>
  # Transformar niveles de sexo
  mutate(across(sex, ~ifelse(.x == "m", "Masculino", "Femenino"))) |>
  mutate(age_c = cut(age,
                           breaks = seq(0,100,5),
                           labels = seq(5,100,5),
                           right = FALSE)) |>
  group_by(age_c, sex) |>
  count() |>
  ungroup() |>
  mutate(pop = case_when(
      sex == "Masculino" ~ -n,
      TRUE ~ n
    ))
```

```{r}
df |>
  ## HAcer plot
  ggplot(aes(x = pop,
             y = age_c,
             fill = sex)) +
  geom_col() +
  scale_fill_manual(values = c("#f49a28", "#0dab9b")) +
  scale_x_continuous(expand = c(0,0))+
  scale_y_discrete(expand = c(0,0))+
  labs(x = "Número de personas", 
       y = "Personas asesinadas", 
       fill = "Sexo") +
  # Poner tema cowplot
  theme_cowplot()
```
Graficas de barra (barplot)
- barplot clasico: número de periodistas asesinados, ver nota https://aje.io/ieh8dd

- barplot horizontal en dos partes (tipo pirámides de edad hombre/mujer) que contrastan cada año número de victimas de violencias israelis y palestinos (datos en https://fr.statista.com/statistiques/1328063/nombre-victmes-palestiniens-israeliens-israel/) y https://visualizingpalestine.org/visual/timeline-of-violence-october-2023/





